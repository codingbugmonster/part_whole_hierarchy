codes to train the DAE
